<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel AI Assistant - –£–º–Ω–∏—è—Ç –ø—ä—Ç–µ–≤–æ–¥–∏—Ç–µ–ª</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh; 
            padding: 6px;
        }
        .chat-container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 14px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 99vh;
        }
        
        .header {
            background: linear-gradient(135deg, #8B4513 0%, #CD853F 100%);
            color: white;
            padding: 10px 10px 6px 10px;
            text-align: center;
        }
        
        .language-switcher {
            display: flex;
            justify-content: center;
            gap: 3px;
            margin-top: 5px;
            flex-wrap: wrap;
        }
        .lang-btn {
            background: rgba(255,255,255,0.15);
            color: #FFEB3B;
            border: 1px solid rgba(255,255,255,0.4);
            padding: 2px 5px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 8px;
            font-weight: 600;
            transition: all 0.3s;
            min-width: 22px;
            text-align: center;
        }
        .lang-btn:hover, .lang-btn.active {
            background: rgba(255,255,255,0.3);
            color: white;
        }
        
        .header h1 {
            font-size: 14px;
            margin-bottom: 3px;
            font-weight: 700;
            line-height: 1.2;
        }
        .header p {
            font-size: 9px;
            opacity: 0.9;
        }
        
        .suggestions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4px;
            padding: 8px;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
        }
        .suggestion-chip {
            background: linear-gradient(135deg, #6D4C41, #8D6E63);
            color: white;
            border: none;
            padding: 5px 6px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 9px;
            transition: all 0.3s ease;
            text-align: center;
            line-height: 1.1;
        }
        .suggestion-chip:hover {
            transform: translateY(-1px);
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
            background: #f8f9fa;
        }
        .message {
            margin-bottom: 6px;
            padding: 6px 8px;
            border-radius: 8px;
            max-width: 96%;
            animation: fadeIn 0.3s ease-in;
            font-size: 11px;
            line-height: 1.2;
        }
        .user-message {
            background: linear-gradient(135deg, #4A6572, #344955);
            color: white;
            margin-left: auto;
        }
        .ai-message {
            background: white;
            border: 1px solid #e0e0e0;
            margin-right: auto;
        }
        
        .input-area {
            padding: 8px;
            background: white;
            border-top: 1px solid #eee;
            display: flex;
            gap: 5px;
        }
        input[type="text"] {
            flex: 1;
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 14px;
            font-size: 11px;
        }
        button {
            background: linear-gradient(135deg, #8B4513, #A0522D);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 14px;
            cursor: pointer;
            font-weight: 600;
            font-size: 11px;
            min-width: 55px;
        }
        
        .info-card {
            background: #E8F5E9;
            border-left: 3px solid #4CAF50;
            border-radius: 5px;
            padding: 6px;
            margin: 4px 0;
            font-size: 10px;
            line-height: 1.2;
        }
        .tip-card {
            background: #FFF3CD;
            border-left: 3px solid #FFC107;
            border-radius: 5px;
            padding: 6px;
            margin: 4px 0;
            font-size: 10px;
            line-height: 1.2;
        }
        .action-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 4px 6px;
            border-radius: 3px;
            cursor: pointer;
            margin: 2px;
            font-size: 9px;
            display: inline-block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(4px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 360px) {
            body { padding: 4px; }
            .chat-container { 
                height: 99vh; 
                border-radius: 12px;
            }
            .header { 
                padding: 8px 8px 4px 8px; 
            }
            .header h1 { 
                font-size: 12px; 
            }
            .header p { font-size: 8px; }
            .suggestions { 
                gap: 3px; 
                padding: 6px; 
            }
            .suggestion-chip { 
                padding: 4px 5px; 
                font-size: 8px; 
            }
            .chat-messages { padding: 6px; }
            .message { 
                padding: 5px 6px; 
                font-size: 10px; 
            }
            .input-area { padding: 6px; }
            input[type="text"] { 
                padding: 5px 8px; 
                font-size: 10px; 
            }
            button { 
                padding: 5px 10px; 
                font-size: 10px; 
                min-width: 50px;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="header">
            <h1 id="header-title">üé® –ü–™–¢–ï–í–û–î–ò–¢–ï–õ AI - –§–õ–û–†–ï–ù–¶–ò–Ø</h1>
            <p id="header-subtitle">–ò–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω –ø–æ–º–æ—â–Ω–∏–∫ –∑–∞ –≤–∞—à–µ—Ç–æ –ø—ä—Ç—É–≤–∞–Ω–µ</p>
            
            <div class="language-switcher">
                <div class="lang-btn active" onclick="changeLanguage('bg')">–ë–ì</div>
                <div class="lang-btn" onclick="changeLanguage('en')">EN</div>
                <div class="lang-btn" onclick="changeLanguage('it')">IT</div>
                <div class="lang-btn" onclick="changeLanguage('es')">ES</div>
                <div class="lang-btn" onclick="changeLanguage('fr')">FR</div>
            </div>
        </div>
        
        <div class="suggestions">
            <div class="suggestion-chip" onclick="askQuestion('onlineTickets')">
                <span id="suggestion-tickets">üé´ –û–Ω–ª–∞–π–Ω –ë–∏–ª–µ—Ç–∏</span>
            </div>
            <div class="suggestion-chip" onclick="askQuestion('timeEstimate')">
                <span id="suggestion-time">‚è±Ô∏è –í—Ä–µ–º–µ</span>
            </div>
            <div class="suggestion-chip" onclick="askQuestion('travelPlan')">
                <span id="suggestion-plan">üóìÔ∏è –ü–ª–∞–Ω</span>
            </div>
            <div class="suggestion-chip" onclick="askQuestion('prices')">
                <span id="suggestion-prices">üí∞ –¶–µ–Ω–∏</span>
            </div>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="message ai-message">
                <strong id="welcome-message">ü§ñ –ó–¥—Ä–∞–≤–µ–π—Ç–µ!</strong> 
                <span id="welcome-text">–ê–∑ —Å—ä–º –≤–∞—à–∏—è—Ç –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω –ø—ä—Ç–µ–≤–æ–¥–∏—Ç–µ–ª. –ú–æ–≥–∞ –¥–∞ –≤–∏ –ø–æ–º–æ–≥–Ω–∞ —Å: –æ–Ω–ª–∞–π–Ω —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏, –ø–ª–∞–Ω–∏—Ä–∞–Ω–µ –Ω–∞ –≤—Ä–µ–º–µ, –º–∞—Ä—à—Ä—É—Ç–∏ –∏ —Ü–µ–Ω–∏!</span>
            </div>
        </div>
        
        <div class="input-area">
            <input type="text" id="userInput" placeholder="–ü–æ–ø–∏—Ç–∞–π—Ç–µ –∑–∞ –≤—Ä–µ–º–µ, —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏ –∏–ª–∏ –ø–ª–∞–Ω–∏—Ä–∞–Ω–µ..." onkeypress="handleKeyPress(event)">
            <button onclick="sendMessage()">
                <span id="send-button">–ò–∑–ø—Ä–∞—Ç–∏</span>
            </button>
        </div>
    </div>

    <script>
        // –ú–£–õ–¢–ò–ï–ó–ò–ß–ù–ê –ë–ê–ó–ê –î–ê–ù–ù–ò
        const translations = {
            bg: {
                texts: {
                    headerTitle: "üé® –ü–™–¢–ï–í–û–î–ò–¢–ï–õ AI - –§–õ–û–†–ï–ù–¶–ò–Ø",
                    headerSubtitle: "–ò–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω –ø–æ–º–æ—â–Ω–∏–∫ –∑–∞ –≤–∞—à–µ—Ç–æ –ø—ä—Ç—É–≤–∞–Ω–µ",
                    onlineTickets: "–û–Ω–ª–∞–π–Ω —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏ –∑–∞ –ö–∞–ø–µ–ª–∞ –ú–µ–¥–∏—á–∏",
                    timeEstimate: "–ö–æ–ª–∫–æ –≤—Ä–µ–º–µ –æ—Ç–Ω–µ–º–∞ –¥–∞ –≤–∏–¥—è –≤—Å–∏—á–∫–∏ –º—É–∑–µ–∏",
                    travelPlan: "–ü–æ–º–æ–≥–Ω–∏ –º–∏ –¥–∞ –ø–ª–∞–Ω–∏—Ä–∞–º –ø—ä—Ç—É–≤–∞–Ω–µ",
                    prices: "–¶–µ–Ω–∏ –∑–∞ –§–ª–æ—Ä–µ–Ω—Ü–∏—è",
                    sendButton: "–ò–∑–ø—Ä–∞—Ç–∏",
                    placeholder: "–ü–æ–ø–∏—Ç–∞–π—Ç–µ –∑–∞ –≤—Ä–µ–º–µ, —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏ –∏–ª–∏ –ø–ª–∞–Ω–∏—Ä–∞–Ω–µ...",
                    welcomeMessage: "ü§ñ –ó–¥—Ä–∞–≤–µ–π—Ç–µ!",
                    welcomeText: "–ê–∑ —Å—ä–º –≤–∞—à–∏—è—Ç –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–µ–Ω –ø—ä—Ç–µ–≤–æ–¥–∏—Ç–µ–ª. –ú–æ–≥–∞ –¥–∞ –≤–∏ –ø–æ–º–æ–≥–Ω–∞ —Å: –æ–Ω–ª–∞–π–Ω —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏, –ø–ª–∞–Ω–∏—Ä–∞–Ω–µ –Ω–∞ –≤—Ä–µ–º–µ, –º–∞—Ä—à—Ä—É—Ç–∏ –∏ —Ü–µ–Ω–∏!"
                },
                responses: {
                    timeEstimate: `<div class="info-card"><strong>‚è±Ô∏è –û–¶–ï–ù–ö–ê –ù–ê –í–†–ï–ú–ï–¢–û –ó–ê –ü–û–°–ï–©–ï–ù–ò–ï:</strong><br><strong>üé® –û–°–ù–û–í–ù–ò –ú–£–ó–ï–ò:</strong><br>‚Ä¢ –ö–∞–ø–µ–ª–∞ –ú–µ–¥–∏—á–∏: <strong>1-2 —á–∞—Å–∞</strong><br>‚Ä¢ –ì–∞–ª–µ—Ä–∏—è –£—Ñ–∏—Ü–∏: <strong>3-4 —á–∞—Å–∞</strong><br>‚Ä¢ –ê–∫–∞–¥–µ–º–∏—è (–î–∞–≤–∏–¥): <strong>1-2 —á–∞—Å–∞</strong><br><strong>üí° –°–™–í–ï–¢:</strong> –†–∞–∑–ø—Ä–µ–¥–µ–ª–µ—Ç–µ –º—É–∑–µ–∏—Ç–µ –≤ —Ä–∞–∑–ª–∏—á–Ω–∏ –¥–Ω–∏ –∏ –∑–∞–ø–æ—á–Ω–µ—Ç–µ —Ä–∞–Ω–æ —Å—É—Ç—Ä–∏–Ω—Ç–∞!</div>`,
                    travelPlan: `<div class="info-card"><strong>üóìÔ∏è –ü–†–ò–ú–ï–†–ï–ù –ü–õ–ê–ù –ó–ê 3 –î–ï–ù–Ø –í–û –§–õ–û–†–ï–ù–¶–ò–Ø:</strong><br><strong>üìÖ –î–ï–ù 1: –†–ï–ù–ï–°–ê–ù–°–û–í–û –ò–ó–ö–£–°–¢–í–û</strong><br>‚Ä¢ 09:00 - –ì–∞–ª–µ—Ä–∏—è –£—Ñ–∏—Ü–∏<br>‚Ä¢ 14:00 - –û–±—è–¥ –≤ –º–µ—Å—Ç–µ–Ω —Ä–µ—Å—Ç–æ—Ä–∞–Ω—Ç<br>‚Ä¢ 16:00 - –ü–æ–Ω—Ç–µ –í–µ–∫—å–æ<br><strong>üìÖ –î–ï–ù 2: –ú–ò–ö–ï–õ–ê–ù–î–ñ–ï–õ–û</strong><br>‚Ä¢ 08:30 - –ê–∫–∞–¥–µ–º–∏—è (–î–∞–≤–∏–¥)<br>‚Ä¢ 11:00 - –ö–∞–ø–µ–ª–∞ –ú–µ–¥–∏—á–∏<br>‚Ä¢ 18:00 - –ó–∞–ª–µ–∑ –≤ –ü–∏–∞—Ü–∞–ª–µ –ú–∏–∫–µ–ª–∞–Ω–¥–∂–µ–ª–æ</div>`,
                    onlineTickets: `<div class="info-card"><strong>üé´ –û–ù–õ–ê–ô–ù –†–ï–ó–ï–†–í–ê–¶–ò–ò - –ö–ê–ü–ï–õ–ê –ú–ï–î–ò–ß–ò</strong><br>üí∞ <strong>–¶–µ–Ω–∞:</strong> 8-20 ‚Ç¨<br>‚è∞ <strong>–†–µ–∑–µ—Ä–≤–∏—Ä–∞–π:</strong> 2-4 —Å–µ–¥–º–∏—Ü–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–æ<br>üåê <strong>–û—Ñ–∏—Ü–∏–∞–ª–µ–Ω —Å–∞–π—Ç:</strong> b-ticket.com<br><strong>‚úÖ –°–™–í–ï–¢–ò:</strong><br>‚Ä¢ –†–µ–∑–µ—Ä–≤–∏—Ä–∞–π —Å—É—Ç—Ä–∏–Ω—Ç–∞<br>‚Ä¢ –ò–∑–±–µ—Ä–∏ "Cappelle Medicee"<br>‚Ä¢ –ü—Ä–∏—Å—Ç–∏–≥–Ω–∏ 15 –º–∏–Ω –ø—Ä–µ–¥–∏ —á–∞—Å–∞</div><button class="action-btn" onclick="window.open('https://www.b-ticket.com/b-Ticket/uffizi/', '_blank')">üé´ –û—Ñ–∏—Ü–∏–∞–ª–µ–Ω —Å–∞–π—Ç</button>`,
                    prices: `<div class="info-card"><strong>üí∞ –¶–ï–ù–ò –ó–ê –§–õ–û–†–ï–ù–¶–ò–Ø</strong><br><strong>üé´ –ú–£–ó–ï–ò:</strong><br>‚Ä¢ –ö–∞–ø–µ–ª–∞ –ú–µ–¥–∏—á–∏: 8-20 ‚Ç¨<br>‚Ä¢ –ì–∞–ª–µ—Ä–∏—è –£—Ñ–∏—Ü–∏: 20-35 ‚Ç¨<br>‚Ä¢ –ê–∫–∞–¥–µ–º–∏—è: 12-25 ‚Ç¨<br><strong>üè® –ü–ê–ö–ï–¢–ò:</strong><br>‚Ä¢ –ö—É–ª—Ç—É—Ä–µ–Ω (5 –¥–Ω–∏): 620 ‚Ç¨<br>‚Ä¢ –ü—Ä–µ–º–∏—É–º (7 –¥–Ω–∏): 890 ‚Ç¨</div>`,
                    unknown: `<div class="tip-card"><strong>ü§î –ù–µ —Ä–∞–∑–±—Ä–∞—Ö –≤—ä–ø—Ä–æ—Å–∞ –≤–∏ –Ω–∞–ø—ä–ª–Ω–æ.</strong><br>–ú–æ–ª—è, –ø–æ–ø–∏—Ç–∞–π—Ç–µ –º–µ –∑–∞:<br>‚Ä¢ <strong>–í—Ä–µ–º–µ</strong> –∑–∞ –ø–æ—Å–µ—â–µ–Ω–∏—è<br>‚Ä¢ <strong>–ë–∏–ª–µ—Ç–∏</strong> –∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏<br>‚Ä¢ <strong>–ü–ª–∞–Ω–æ–≤–µ</strong> –∑–∞ –ø—ä—Ç—É–≤–∞–Ω–µ<br>‚Ä¢ <strong>–¶–µ–Ω–∏</strong> –∑–∞ –º—É–∑–µ–∏</div>`
                }
            },
            en: {
                texts: {
                    headerTitle: "üé® TRAVEL GUIDE AI - FLORENCE",
                    headerSubtitle: "Your intelligent travel companion",
                    onlineTickets: "Online tickets for Medici Chapel",
                    timeEstimate: "How much time to see all museums",
                    travelPlan: "Help me plan my trip",
                    prices: "Prices for Florence",
                    sendButton: "Send",
                    placeholder: "Ask about time, reservations or planning...",
                    welcomeMessage: "ü§ñ Hello!",
                    welcomeText: "I'm your intelligent travel guide. I can help with: online reservations, time planning, routes and prices!"
                },
                responses: {
                    timeEstimate: `<div class="info-card"><strong>‚è±Ô∏è TIME ESTIMATES FOR VISITS:</strong><br><strong>üé® MAIN MUSEUMS:</strong><br>‚Ä¢ Medici Chapel: <strong>1-2 hours</strong><br>‚Ä¢ Uffizi Gallery: <strong>3-4 hours</strong><br>‚Ä¢ Accademia (David): <strong>1-2 hours</strong><br><strong>üí° TIP:</strong> Spread museums across different days and start early morning!</div>`,
                    travelPlan: `<div class="info-card"><strong>üóìÔ∏è SAMPLE 3-DAY FLORENCE ITINERARY:</strong><br><strong>üìÖ DAY 1: RENAISSANCE ART</strong><br>‚Ä¢ 09:00 - Uffizi Gallery<br>‚Ä¢ 14:00 - Lunch in local restaurant<br>‚Ä¢ 16:00 - Ponte Vecchio<br><strong>üìÖ DAY 2: MICHELANGELO</strong><br>‚Ä¢ 08:30 - Accademia (David)<br>‚Ä¢ 11:00 - Medici Chapel<br>‚Ä¢ 18:00 - Sunset at Piazzale Michelangelo</div>`,
                    onlineTickets: `<div class="info-card"><strong>üé´ ONLINE RESERVATIONS - MEDICI CHAPEL</strong><br>üí∞ <strong>Price:</strong> 8-20 ‚Ç¨<br>‚è∞ <strong>Book:</strong> 2-4 weeks in advance<br>üåê <strong>Official website:</strong> b-ticket.com<br><strong>‚úÖ TIPS:</strong><br>‚Ä¢ Book morning slots<br>‚Ä¢ Select "Cappelle Medicee"<br>‚Ä¢ Arrive 15 min before your time</div><button class="action-btn" onclick="window.open('https://www.b-ticket.com/b-Ticket/uffizi/', '_blank')">üé´ Official Website</button>`,
                    prices: `<div class="info-card"><strong>üí∞ FLORENCE PRICES</strong><br><strong>üé´ MUSEUMS:</strong><br>‚Ä¢ Medici Chapel: 8-20 ‚Ç¨<br>‚Ä¢ Uffizi Gallery: 20-35 ‚Ç¨<br>‚Ä¢ Accademia: 12-25 ‚Ç¨<br><strong>üè® PACKAGES:</strong><br>‚Ä¢ Cultural (5 days): 620 ‚Ç¨<br>‚Ä¢ Premium (7 days): 890 ‚Ç¨</div>`,
                    unknown: `<div class="tip-card"><strong>ü§î I didn't fully understand your question.</strong><br>Please ask me about:<br>‚Ä¢ <strong>Time</strong> for visits<br>‚Ä¢ <strong>Tickets</strong> and reservations<br>‚Ä¢ <strong>Travel</strong> plans<br>‚Ä¢ <strong>Prices</strong> for museums</div>`
                }
            },
            it: {
                texts: {
                    headerTitle: "üé® GUIDA AI - FIRENZE",
                    headerSubtitle: "Il tuo compagno di viaggio intelligente",
                    onlineTickets: "Prenotazioni online per Cappelle Medicee",
                    timeEstimate: "Quanto tempo per vedere tutti i musei",
                    travelPlan: "Aiutami a pianificare il viaggio",
                    prices: "Prezzi per Firenze",
                    sendButton: "Invia",
                    placeholder: "Chiedi informazioni su tempo, prenotazioni o pianificazione...",
                    welcomeMessage: "ü§ñ Ciao!",
                    welcomeText: "Sono la tua guida intelligente. Posso aiutarti con: prenotazioni online, pianificazione del tempo, itinerari e prezzi!"
                },
                responses: {
                    timeEstimate: `<div class="info-card"><strong>‚è±Ô∏è TEMPO STIMATO PER LE VISITE:</strong><br><strong>üé® MUSEI PRINCIPALI:</strong><br>‚Ä¢ Cappelle Medicee: <strong>1-2 ore</strong><br>‚Ä¢ Galleria degli Uffizi: <strong>3-4 ore</strong><br>‚Ä¢ Accademia (David): <strong>1-2 ore</strong><br><strong>üí° CONSIGLIO:</strong> Distribuisci i musei in giorni diversi e inizia di prima mattina!</div>`,
                    travelPlan: `<div class="info-card"><strong>üóìÔ∏è ITINERARIO DI 3 GIORNI A FIRENZE:</strong><br><strong>üìÖ GIORNO 1: ARTE RINASCIMENTALE</strong><br>‚Ä¢ 09:00 - Galleria degli Uffizi<br>‚Ä¢ 14:00 - Pranzo in ristorante locale<br>‚Ä¢ 16:00 - Ponte Vecchio<br><strong>üìÖ GIORNO 2: MICHELANGELO</strong><br>‚Ä¢ 08:30 - Accademia (David)<br>‚Ä¢ 11:00 - Cappelle Medicee<br>‚Ä¢ 18:00 - Tramonto al Piazzale Michelangelo</div>`,
                    onlineTickets: `<div class="info-card"><strong>üé´ PRENOTAZIONI ONLINE - CAPPELLE MEDICEE</strong><br>üí∞ <strong>Prezzo:</strong> 8-20 ‚Ç¨<br>‚è∞ <strong>Prenota:</strong> 2-4 settimane prima<br>üåê <strong>Sito ufficiale:</strong> b-ticket.com<br><strong>‚úÖ CONSIGLI:</strong><br>‚Ä¢ Prenota gli slot mattutini<br>‚Ä¢ Seleziona "Cappelle Medicee"<br>‚Ä¢ Arriva 15 min prima dell'orario</div><button class="action-btn" onclick="window.open('https://www.b-ticket.com/b-Ticket/uffizi/', '_blank')">üé´ Sito Ufficiale</button>`,
                    prices: `<div class="info-card"><strong>üí∞ PREZZI FIRENZE</strong><br><strong>üé´ MUSEI:</strong><br>‚Ä¢ Cappelle Medicee: 8-20 ‚Ç¨<br>‚Ä¢ Galleria Uffizi: 20-35 ‚Ç¨<br>‚Ä¢ Accademia: 12-25 ‚Ç¨<br><strong>üè® PACCHETTI:</strong><br>‚Ä¢ Culturale (5 giorni): 620 ‚Ç¨<br>‚Ä¢ Premium (7 giorni): 890 ‚Ç¨</div>`,
                    unknown: `<div class="tip-card"><strong>ü§î Non ho capito completamente la tua domanda.</strong><br>Per favore chiedimi di:<br>‚Ä¢ <strong>Tempo</strong> per le visite<br>‚Ä¢ <strong>Biglietti</strong> e prenotazioni<br>‚Ä¢ <strong>Piani</strong> di viaggio<br>‚Ä¢ <strong>Prezzi</strong> per i musei</div>`
                }
            },
            es: {
                texts: {
                    headerTitle: "üé® GU√çA AI - FLORENCIA",
                    headerSubtitle: "Tu compa√±ero de viaje inteligente",
                    onlineTickets: "Reservas online para Capilla Medici",
                    timeEstimate: "Cu√°nto tiempo para ver todos los museos",
                    travelPlan: "Ay√∫dame a planificar el viaje",
                    prices: "Precios para Florencia",
                    sendButton: "Enviar",
                    placeholder: "Pregunta sobre tiempo, reservas o planificaci√≥n...",
                    welcomeMessage: "ü§ñ ¬°Hola!",
                    welcomeText: "Soy tu gu√≠a inteligente. ¬°Puedo ayudarte con: reservas online, planificaci√≥n de tiempo, rutas y precios!"
                },
                responses: {
                    timeEstimate: `<div class="info-card"><strong>‚è±Ô∏è ESTIMACI√ìN DE TIEMPO PARA VISITAS:</strong><br><strong>üé® MUSEOS PRINCIPALES:</strong><br>‚Ä¢ Capilla Medici: <strong>1-2 horas</strong><br>‚Ä¢ Galer√≠a Uffizi: <strong>3-4 horas</strong><br>‚Ä¢ Academia (David): <strong>1-2 horas</strong><br><strong>üí° CONSEJO:</strong> ¬°Distribuye los museos en d√≠as diferentes y comienza temprano por la ma√±ana!</div>`,
                    travelPlan: `<div class="info-card"><strong>üóìÔ∏è ITINERARIO DE 3 D√çAS EN FLORENCIA:</strong><br><strong>üìÖ D√çA 1: ARTE RENACENTISTA</strong><br>‚Ä¢ 09:00 - Galer√≠a Uffizi<br>‚Ä¢ 14:00 - Almuerzo en restaurante local<br>‚Ä¢ 16:00 - Ponte Vecchio<br><strong>üìÖ D√çA 2: MIGUEL √ÅNGEL</strong><br>‚Ä¢ 08:30 - Academia (David)<br>‚Ä¢ 11:00 - Capilla Medici<br>‚Ä¢ 18:00 - Atardecer en Piazzale Michelangelo</div>`,
                    onlineTickets: `<div class="info-card"><strong>üé´ RESERVAS ONLINE - CAPILLA MEDICI</strong><br>üí∞ <strong>Precio:</strong> 8-20 ‚Ç¨<br>‚è∞ <strong>Reserva:</strong> 2-4 semanas antes<br>üåê <strong>Sitio oficial:</strong> b-ticket.com<br><strong>‚úÖ CONSEJOS:</strong><br>‚Ä¢ Reserva horarios matutinos<br>‚Ä¢ Selecciona "Cappelle Medicee"<br>‚Ä¢ Llega 15 min antes de tu hora</div><button class="action-btn" onclick="window.open('https://www.b-ticket.com/b-Ticket/uffizi/', '_blank')">üé´ Sitio Oficial</button>`,
                    prices: `<div class="info-card"><strong>üí∞ PRECIOS FLORENCIA</strong><br><strong>üé´ MUSEOS:</strong><br>‚Ä¢ Capilla Medici: 8-20 ‚Ç¨<br>‚Ä¢ Galer√≠a Uffizi: 20-35 ‚Ç¨<br>‚Ä¢ Academia: 12-25 ‚Ç¨<br><strong>üè® PAQUETES:</strong><br>‚Ä¢ Cultural (5 d√≠as): 620 ‚Ç¨<br>‚Ä¢ Premium (7 d√≠as): 890 ‚Ç¨</div>`,
                    unknown: `<div class="tip-card"><strong>ü§î No entend√≠ completamente tu pregunta.</strong><br>Por favor preg√∫ntame sobre:<br>‚Ä¢ <strong>Tiempo</strong> para visitas<br>‚Ä¢ <strong>Entradas</strong> y reservas<br>‚Ä¢ <strong>Planes</strong> de viaje<br>‚Ä¢ <strong>Precios</strong> para museos</div>`
                }
            },
            fr: {
                texts: {
                    headerTitle: "üé® GUIDE AI - FLORENCE",
                    headerSubtitle: "Votre compagnon de voyage intelligent",
                    onlineTickets: "R√©servations en ligne pour Chapelle Medici",
                    timeEstimate: "Temps n√©cessaire pour voir tous les mus√©es",
                    travelPlan: "Aidez-moi √† planifier mon voyage",
                    prices: "Prix pour Florence",
                    sendButton: "Envoyer",
                    placeholder: "Demandez sur le temps, les r√©servations ou la planification...",
                    welcomeMessage: "ü§ñ Bonjour!",
                    welcomeText: "Je suis votre guide intelligent. Je peux vous aider avec: r√©servations en ligne, planification du temps, itin√©raires et prix!"
                },
                responses: {
                    timeEstimate: `<div class="info-card"><strong>‚è±Ô∏è ESTIMATION DU TEMPS DE VISITE:</strong><br><strong>üé® MUS√âES PRINCIPAUX:</strong><br>‚Ä¢ Chapelle Medici: <strong>1-2 heures</strong><br>‚Ä¢ Galerie des Offices: <strong>3-4 heures</strong><br>‚Ä¢ Acad√©mie (David): <strong>1-2 heures</strong><br><strong>üí° CONSEIL:</strong> R√©partissez les mus√©es sur diff√©rents jours et commencez t√¥t le matin!</div>`,
                    travelPlan: `<div class="info-card"><strong>üóìÔ∏è ITIN√âRAIRE DE 3 JOURS √Ä FLORENCE:</strong><br><strong>üìÖ JOUR 1: ART RENAISSANCE</strong><br>‚Ä¢ 09:00 - Galerie des Offices<br>‚Ä¢ 14:00 - D√©jeuner dans un restaurant local<br>‚Ä¢ 16:00 - Ponte Vecchio<br><strong>üìÖ JOUR 2: MICHEL-ANGE</strong><br>‚Ä¢ 08:30 - Acad√©mie (David)<br>‚Ä¢ 11:00 - Chapelle Medici<br>‚Ä¢ 18:00 - Coucher de soleil au Piazzale Michelangelo</div>`,
                    onlineTickets: `<div class="info-card"><strong>üé´ R√âSERVATIONS EN LIGNE - CHAPELLE MEDICI</strong><br>üí∞ <strong>Prix:</strong> 8-20 ‚Ç¨<br>‚è∞ <strong>R√©servez:</strong> 2-4 semaines √† l'avance<br>üåê <strong>Site officiel:</strong> b-ticket.com<br><strong>‚úÖ CONSEILS:</strong><br>‚Ä¢ R√©servez les cr√©neaux matinaux<br>‚Ä¢ S√©lectionnez "Cappelle Medicee"<br>‚Ä¢ Arrivez 15 min avant votre heure</div><button class="action-btn" onclick="window.open('https://www.b-ticket.com/b-Ticket/uffizi/', '_blank')">üé´ Site Officiel</button>`,
                    prices: `<div class="info-card"><strong>üí∞ PRIX FLORENCE</strong><br><strong>üé´ MUS√âES:</strong><br>‚Ä¢ Chapelle Medici: 8-20 ‚Ç¨<br>‚Ä¢ Galerie des Offices: 20-35 ‚Ç¨<br>‚Ä¢ Acad√©mie: 12-25 ‚Ç¨<br><strong>üè® FORFAITS:</strong><br>‚Ä¢ Culturel (5 jours): 620 ‚Ç¨<br>‚Ä¢ Premium (7 jours): 890 ‚Ç¨</div>`,
                    unknown: `<div class="tip-card"><strong>ü§î Je n'ai pas bien compris votre question.</strong><br>Veuillez me demander :<br>‚Ä¢ <strong>Temps</strong> pour les visites<br>‚Ä¢ <strong>Billets</strong> et r√©servations<br>‚Ä¢ <strong>Plans</strong> de voyage<br>‚Ä¢ <strong>Prix</strong> pour les mus√©es</div>`
                }
            }
        };

        // –ü–ï–†–°–û–ù–ê–õ–ò–ó–ê–¶–ò–Ø - –ü–™–õ–ù–ê –ò–ú–ü–õ–ï–ú–ï–ù–¢–ê–¶–ò–Ø
        let userProfile = {
            searchHistory: [],
            preferences: {
                travelType: null,
                budget: null,
                interests: [],
                season: null
            },
            favoriteCities: [],
            lastSearches: []
        };

        const enhancedCityDatabase = {
            "—Ä–∏–º": {
                name: "–†–∏–º",
                keywords: ["—Ä–∏–º", "roma", "rome"],
                categories: ["history", "culture", "romantic", "food", "architecture"],
                tags: ["–∞–Ω—Ç–∏—á–µ–Ω", "—Ä–µ–ª–∏–≥–∏–æ–∑–µ–Ω", "–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞", "–≤–∫—É—Å–Ω–∞ —Ö—Ä–∞–Ω–∞", "—Ä–æ–º–∞–Ω—Ç–∏—á–µ–Ω"],
                budgetLevel: "medium",
                bestSeasons: ["spring", "autumn"],
                familyFriendly: true,
                romanticScore: 9,
                info: {
                    mainAttractions: ["–ö–æ–ª–∏–∑–µ—É–º", "–í–∞—Ç–∏–∫–∞–Ω", "–ü–∞–Ω—Ç–µ–æ–Ω", "–§–æ–Ω—Ç–∞–Ω –¥–∏ –¢—Ä–µ–≤–∏"],
                    museums: ["–í–∞—Ç–∏–∫–∞–Ω—Å–∫–∏ –º—É–∑–µ–∏", "–ú—É–∑–µ–∏ –Ω–∞ –ö–∞–ø–∏—Ç–æ–ª–∏—è", "–ì–∞–ª–µ—Ä–∏—è –ë–æ—Ä–≥–µ–∑–µ"],
                    prices: { museums: "15-25‚Ç¨", transport: "7‚Ç¨/–¥–Ω–µ–≤–µ–Ω –±–∏–ª–µ—Ç", food: "15-30‚Ç¨ –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–µ" },
                    timeNeeded: "4-5 –¥–Ω–∏",
                    bestTime: "–ú–∞—Ä—Ç-–ú–∞–π, –°–µ–ø—Ç–µ–º–≤—Ä–∏-–û–∫—Ç–æ–º–≤—Ä–∏"
                }
            },
            "–ø–∞—Ä–∏–∂": {
                name: "–ü–∞—Ä–∏–∂",
                keywords: ["–ø–∞—Ä–∏–∂", "paris"],
                categories: ["romantic", "culture", "shopping", "food", "art"],
                tags: ["—Ä–æ–º–∞–Ω—Ç–∏—á–µ–Ω", "–º–æ–¥–∞", "–∏–∑–∫—É—Å—Ç–≤–æ", "–≥–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—è", "–ª—É–∫—Å–æ–∑–µ–Ω"],
                budgetLevel: "luxury",
                bestSeasons: ["spring", "summer"],
                familyFriendly: true,
                romanticScore: 10,
                info: {
                    mainAttractions: ["–ê–π—Ñ–µ–ª–æ–≤–∞ –∫—É–ª–∞", "–õ—É–≤—ä—Ä", "–ù–æ—Ç—Ä –î–∞–º", "–¢—Ä–∏—É–º—Ñ–∞–ª–Ω–∞ –∞—Ä–∫–∞"],
                    museums: ["–õ—É–≤—ä—Ä", "–ú—É–∑–µ–π –¥'–û—Ä—Å–µ", "–¶–µ–Ω—Ç—ä—Ä –ü–æ–º–ø–∏–¥—É"],
                    prices: { museums: "12-25‚Ç¨", transport: "12‚Ç¨/–¥–Ω–µ–≤–µ–Ω –±–∏–ª–µ—Ç", food: "20-40‚Ç¨ –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–µ" },
                    timeNeeded: "4-5 –¥–Ω–∏",
                    bestTime: "–ê–ø—Ä–∏–ª-–Æ–Ω–∏, –°–µ–ø—Ç–µ–º–≤—Ä–∏-–û–∫—Ç–æ–º–≤—Ä–∏"
                }
            },
            "–±–∞—Ä—Å–µ–ª–æ–Ω–∞": {
                name: "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞",
                keywords: ["–±–∞—Ä—Å–µ–ª–æ–Ω–∞", "barcelona"],
                categories: ["beach", "culture", "nightlife", "architecture", "family"],
                tags: ["–ø–ª–∞–∂", "–ì–∞—É–¥–∏", "–Ω–æ—â–µ–Ω –∂–∏–≤–æ—Ç", "–º–æ–¥–µ—Ä–Ω–∏–∑—ä–º", "—Å–µ–º–µ–µ–Ω"],
                budgetLevel: "medium",
                bestSeasons: ["spring", "summer", "autumn"],
                familyFriendly: true,
                romanticScore: 7,
                info: {
                    mainAttractions: ["–°–∞–≥—Ä–∞–¥–∞ –§–∞–º–∏–ª–∏—è", "–ü–∞—Ä–∫ –ì—É–µ–ª", "–õ–∞ –†–∞–º–±–ª–∞", "–ì–æ—Ç–∏—á–µ—Å–∫–∏ –∫–≤–∞—Ä—Ç–∞–ª"],
                    museums: ["–ú—É–∑–µ–π –ü–∏–∫–∞—Å–æ", "–§–æ–Ω–¥–∞—Ü–∏—è –ú–∏—Ä–æ", "MNAC"],
                    prices: { museums: "10-20‚Ç¨", transport: "10‚Ç¨/–¥–Ω–µ–≤–µ–Ω –±–∏–ª–µ—Ç", food: "15-30‚Ç¨ –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–µ" },
                    timeNeeded: "3-4 –¥–Ω–∏",
                    bestTime: "–ú–∞–π-–Æ–Ω–∏, –°–µ–ø—Ç–µ–º–≤—Ä–∏"
                }
            },
            "–ø—Ä–∞–≥–∞": {
                name: "–ü—Ä–∞–≥–∞",
                keywords: ["–ø—Ä–∞–≥–∞", "prague", "praha"],
                categories: ["history", "culture", "budget", "romantic"],
                tags: ["–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏", "–µ–≤—Ç–∏–Ω", "—Ä–æ–º–∞–Ω—Ç–∏—á–µ–Ω", "–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"],
                budgetLevel: "budget",
                bestSeasons: ["spring", "autumn"],
                familyFriendly: true,
                romanticScore: 8,
                info: {
                    mainAttractions: ["–ü—Ä–∞–∂–∫–∏ –∑–∞–º—ä–∫", "–ö–∞—Ä–ª–æ–≤ –º–æ—Å—Ç", "–ê—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏ —á–∞—Å–æ–≤–Ω–∏–∫", "–°—Ç–∞—Ä–æ–º–µ—Å—Ç–∫–∏ –ø–ª–æ—â–∞–¥"],
                    museums: ["–ù–∞—Ü–∏–æ–Ω–∞–ª–µ–Ω –º—É–∑–µ–π", "–ú—É–∑–µ–π –Ω–∞ –∫–æ–º—É–Ω–∏–∑–º–∞", "–ú—É–∑–µ–π –ö–∞–º–ø–∞"],
                    prices: { museums: "8-15‚Ç¨", transport: "5‚Ç¨/–¥–Ω–µ–≤–µ–Ω –±–∏–ª–µ—Ç", food: "10-20‚Ç¨ –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–µ" },
                    timeNeeded: "3-4 –¥–Ω–∏",
                    bestTime: "–ê–ø—Ä–∏–ª-–ú–∞–π, –°–µ–ø—Ç–µ–º–≤—Ä–∏-–û–∫—Ç–æ–º–≤—Ä–∏"
                }
            },
            "–±—É–¥–∞–ø–µ—â–∞": {
                name: "–ë—É–¥–∞–ø–µ—â–∞",
                keywords: ["–±—É–¥–∞–ø–µ—â–∞", "budapest"],
                categories: ["history", "culture", "budget", "romantic", "spa"],
                tags: ["–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏", "–µ–≤—Ç–∏–Ω", "—Ä–æ–º–∞–Ω—Ç–∏—á–µ–Ω", "—Å–ø–∞", "—Ç–µ—Ä–º–∞–ª–Ω–∏ –±–∞–Ω–∏"],
                budgetLevel: "budget",
                bestSeasons: ["spring", "autumn"],
                familyFriendly: true,
                romanticScore: 8,
                info: {
                    mainAttractions: ["–ü–∞—Ä–ª–∞–º–µ–Ω—Ç", "–†–∏–±–∞—Ä—Å–∫–∏ –±–∞—Å—Ç–∏–æ–Ω", "–ë—É–¥–∞–π—Å–∫–∏ –∑–∞–º—ä–∫", "–¶–µ–ø–µ–Ω –º–æ—Å—Ç"],
                    museums: ["–ù–∞—Ü–∏–æ–Ω–∞–ª–µ–Ω –º—É–∑–µ–π", "–ú—É–∑–µ–π –Ω–∞ –∏–∑–∫—É—Å—Ç–≤–∞—Ç–∞", "–î–æ–º –Ω–∞ —Ç–µ—Ä—Ä–æ—Ä–∞"],
                    prices: { museums: "8-15‚Ç¨", transport: "5‚Ç¨/–¥–Ω–µ–≤–µ–Ω –±–∏–ª–µ—Ç", food: "10-20‚Ç¨ –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–µ" },
                    timeNeeded: "3-4 –¥–Ω–∏",
                    bestTime: "–ê–ø—Ä–∏–ª-–ú–∞–π, –°–µ–ø—Ç–µ–º–≤—Ä–∏-–û–∫—Ç–æ–º–≤—Ä–∏"
                }
            },
            "–ª–∏—Å–∞–±–æ–Ω": {
                name: "–õ–∏—Å–∞–±–æ–Ω",
                keywords: ["–ª–∏—Å–∞–±–æ–Ω", "lisbon", "lisboa"],
                categories: ["culture", "beach", "budget", "food", "hills"],
                tags: ["—Ö—ä–ª–º–∏—Å—Ç", "–µ–≤—Ç–∏–Ω", "–ø–ª–∞–∂", "–≤–∫—É—Å–Ω–∞ —Ö—Ä–∞–Ω–∞", "—Ç—Ä–∞–º–≤–∞–∏"],
                budgetLevel: "budget",
                bestSeasons: ["spring", "autumn"],
                familyFriendly: true,
                romanticScore: 7,
                info: {
                    mainAttractions: ["–ó–∞–º—ä–∫ –°–∞–æ –•–æ—Ä—Ö–µ", "–ë–µ–ª–µ–Ω—Å–∫–∞ –∫—É–ª–∞", "–ú–æ–Ω–∞—Å—Ç–∏—Ä –Ω–∞ –ô–µ—Ä–æ–Ω–∏–º–∏—Ç–∏—Ç–µ", "–ê–ª—Ñ–∞–º–∞"],
                    museums: ["–ú—É–∑–µ–π –Ω–∞ –∫–∞—Ä–µ—Ç–∏", "–ú—É–∑–µ–π –Ω–∞ –∏–∑–∫—É—Å—Ç–≤–æ—Ç–æ", "MAAT"],
                    prices: { museums: "8-15‚Ç¨", transport: "6‚Ç¨/–¥–Ω–µ–≤–µ–Ω –±–∏–ª–µ—Ç", food: "12-25‚Ç¨ –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–µ" },
                    timeNeeded: "3-4 –¥–Ω–∏",
                    bestTime: "–ú–∞—Ä—Ç-–ú–∞–π, –°–µ–ø—Ç–µ–º–≤—Ä–∏-–û–∫—Ç–æ–º–≤—Ä–∏"
                }
            },
            "–Ω–∏—Ü–∞": {
                name: "–ù–∏—Ü–∞",
                keywords: ["–Ω–∏—Ü–∞", "nice"],
                categories: ["beach", "romantic", "luxury", "french_riviera"],
                tags: ["–ø–ª–∞–∂", "—Ä–æ–º–∞–Ω—Ç–∏—á–µ–Ω", "–ª—É–∫—Å–æ–∑–µ–Ω", "–õ–∞–∑—É—Ä–µ–Ω –±—Ä—è–≥", "—Ñ—Ä–µ–Ω—Å–∫–∞ —Ä–∏–≤–∏–µ—Ä–∞"],
                budgetLevel: "luxury",
                bestSeasons: ["spring", "summer"],
                familyFriendly: true,
                romanticScore: 9,
                info: {
                    mainAttractions: ["–ê–Ω–≥–ª–∏–π—Å–∫–∞ –Ω–∞–±–µ—Ä–µ–∂–Ω–∞", "–°—Ç–∞—Ä–∏ –≥—Ä–∞–¥", "–ó–∞–º—ä–∫–æ–≤–∞ —Ö—ä–ª–º", "–ú–∞—Ä–∫ –®–∞–≥–∞–ª –º—É–∑–µ–π"],
                    museums: ["–ú—É–∑–µ–π –Ω–∞ –∏–∑–∫—É—Å—Ç–≤–∞—Ç–∞", "–ú–ê–ú–ê–ö", "–ú—É–∑–µ–π –ú–∞—Ç–∏—Å"],
                    prices: { museums: "10-15‚Ç¨", transport: "5‚Ç¨/–¥–Ω–µ–≤–µ–Ω", food: "20-40‚Ç¨" },
                    timeNeeded: "2-3 –¥–Ω–∏",
                    bestTime: "–ú–∞–π-–°–µ–ø—Ç–µ–º–≤—Ä–∏"
                }
            },
            "–≤–µ–Ω–µ—Ü–∏—è": {
                name: "–í–µ–Ω–µ—Ü–∏—è",
                keywords: ["–≤–µ–Ω–µ—Ü–∏—è", "venice", "venezia"],
                categories: ["romantic", "culture", "unique", "canals"],
                tags: ["—Ä–æ–º–∞–Ω—Ç–∏—á–µ–Ω", "–∫–∞–Ω–∞–ª–∏", "—É–Ω–∏–∫–∞–ª–µ–Ω", "–≥–æ–Ω–¥–æ–ª–∏", "–ª—É–∫—Å–æ–∑–µ–Ω"],
                budgetLevel: "luxury",
                bestSeasons: ["spring", "autumn"],
                familyFriendly: true,
                romanticScore: 10,
                info: {
                    mainAttractions: ["–ü–ª–æ—â–∞–¥ –°–∞–Ω –ú–∞—Ä–∫–æ", "–î–≤–æ—Ä–µ—Ü –î–æ–∂–µ—Ç–µ", "–ú–æ—Å—Ç –í–∑–¥–∏—Ö–≤–∞–Ω–∏—è", "–ö–∞–Ω–∞–ª–∏"],
                    museums: ["–ì–∞–ª–µ—Ä–∏—è –ê–∫–∞–¥–µ–º–∏—è", "–ú—É–∑–µ–π –Ω–∞ —Å—Ç—ä–∫–ª–æ—Ç–æ", "–ü–µ–≥–∏ –ì—É–≥–µ–Ω—Ö–∞–π–º –∫–æ–ª–µ–∫—Ü–∏—è"],
                    prices: { museums: "15-25‚Ç¨", transport: "20‚Ç¨/–≤–æ–¥–Ω–æ —Ç–∞–∫—Å–∏", food: "25-50‚Ç¨" },
                    timeNeeded: "2-3 –¥–Ω–∏",
                    bestTime: "–ê–ø—Ä–∏–ª-–ú–∞–π, –°–µ–ø—Ç–µ–º–≤—Ä–∏-–û–∫—Ç–æ–º–≤—Ä–∏"
                }
            },
            "–∞–º—Å—Ç–µ—Ä–¥–∞–º": {
                name: "–ê–º—Å—Ç–µ—Ä–¥–∞–º",
                keywords: ["–∞–º—Å—Ç–µ—Ä–¥–∞–º", "amsterdam"],
                categories: ["culture", "canals", "nightlife", "art", "bicycles"],
                tags: ["–∫–∞–Ω–∞–ª–∏", "–≤–µ–ª–æ—Å–∏–ø–µ–¥–∏", "–Ω–æ—â–µ–Ω –∂–∏–≤–æ—Ç", "–∏–∑–∫—É—Å—Ç–≤–æ", "—Ç–æ–ª–µ—Ä–∞–Ω—Ç–µ–Ω"],
                budgetLevel: "medium",
                bestSeasons: ["spring", "summer"],
                familyFriendly: true,
                romanticScore: 7,
                info: {
                    mainAttractions: ["–ö–∞–Ω–∞–ª–∏", "–†–∞–π–∫—Å–º—É–∑–µ–π", "–ê–Ω –§—Ä–∞–Ω–∫ –∫—ä—â–∞", "–î–∞–º –ø–ª–æ—â–∞–¥"],
                    museums: ["–†–∞–π–∫—Å–º—É–∑–µ–π", "–í–∞–Ω –ì–æ–≥ –º—É–∑–µ–π", "–ê–Ω –§—Ä–∞–Ω–∫ –∫—ä—â–∞"],
                    prices: { museums: "15-25‚Ç¨", transport: "8‚Ç¨/–¥–Ω–µ–≤–µ–Ω –±–∏–ª–µ—Ç", food: "15-30‚Ç¨ –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–µ" },
                    timeNeeded: "3-4 –¥–Ω–∏",
                    bestTime: "–ê–ø—Ä–∏–ª-–û–∫—Ç–æ–º–≤—Ä–∏"
                }
            }
        };

        let currentLanguage = translations.bg;

        function changeLanguage(lang) {
            currentLanguage = translations[lang];
            
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const targetBtn = document.querySelector(`.lang-btn[onclick="changeLanguage('${lang}')"]`);
            if (targetBtn) {
                targetBtn.classList.add('active');
            }
            
            document.getElementById('header-title').textContent = currentLanguage.texts.headerTitle;
            document.getElementById('header-subtitle').textContent = currentLanguage.texts.headerSubtitle;
            document.getElementById('userInput').placeholder = currentLanguage.texts.placeholder;
            document.getElementById('send-button').textContent = currentLanguage.texts.sendButton;
            document.getElementById('welcome-message').textContent = currentLanguage.texts.welcomeMessage;
            document.getElementById('welcome-text').textContent = currentLanguage.texts.welcomeText;
        }

        function getAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            updateUserProfile(lowerMessage);
            
            if (lowerMessage.includes('–ø–æ–¥–æ–±–Ω–∏ –Ω–∞') || lowerMessage.includes('similar to') || lowerMessage.includes('–∫–∞—Ç–æ')) {
                return getSimilarCitiesResponse(message);
            }
            
            if (lowerMessage.includes('–ø—Ä–µ–ø–æ—Ä—ä—á–∞–π') || lowerMessage.includes('recommend') || lowerMessage.includes('–ø—Ä–µ–¥–ª–æ–∂–∏')) {
                return getPersonalizedRecommendations(message);
            }
            
            if (lowerMessage.includes('–µ–≤—Ç–∏–Ω–æ') || lowerMessage.includes('–±—é–¥–∂–µ—Ç') || lowerMessage.includes('cheap') || lowerMessage.includes('–∏–∫–æ–Ω–æ–º–∏—á–Ω–æ')) {
                return getBudgetRecommendations();
            }
            
            if (lowerMessage.includes('–ª—É–∫—Å–æ–∑') || lowerMessage.includes('luxury') || lowerMessage.includes('—Å–∫—ä–ø')) {
                return getLuxuryRecommendations();
            }
            
            if (lowerMessage.includes('—Ä–æ–º–∞–Ω—Ç–∏—á') || lowerMessage.includes('romantic') || lowerMessage.includes('–º–µ–¥–µ–Ω –º–µ—Å–µ—Ü')) {
                return getRomanticRecommendations();
            }
            
            if (lowerMessage.includes('–ø–ª–∞–∂') || lowerMessage.includes('beach') || lowerMessage.includes('–º–æ—Ä–µ')) {
                return getBeachRecommendations();
            }
            
            if (lowerMessage.includes('–∏—Å—Ç–æ—Ä–∏') || lowerMessage.includes('history') || lowerMessage.includes('–∫—É–ª—Ç—É—Ä')) {
                return getCulturalRecommendations();
            }
            
            if (lowerMessage.includes('–ª—è—Ç–æ') || lowerMessage.includes('summer')) {
                return getSeasonalRecommendations('summer');
            }
            
            if (lowerMessage.includes('–∑–∏–º–∞') || lowerMessage.includes('winter')) {
                return getSeasonalRecommendations('winter');
            }
            
            if (lowerMessage.includes('–ø—Ä–æ–ª–µ—Ç') || lowerMessage.includes('spring')) {
                return getSeasonalRecommendations('spring');
            }
            
            if (lowerMessage.includes('–µ—Å–µ–Ω') || lowerMessage.includes('autumn')) {
                return getSeasonalRecommendations('autumn');
            }
            
            if (lowerMessage.includes('–∏—Å—Ç–æ—Ä–∏—è') || lowerMessage.includes('history') || lowerMessage.includes('—Ç—ä—Ä—Å–µ–Ω–∏—è')) {
                return getSearchHistory();
            }
            
            for (const [cityKey, cityData] of Object.entries(enhancedCityDatabase)) {
                if (cityData.keywords.some(keyword => lowerMessage.includes(keyword))) {
                    userProfile.searchHistory.push(cityData.name);
                    userProfile.lastSearches.unshift(cityData.name);
                    if (userProfile.lastSearches.length > 5) userProfile.lastSearches.pop();
                    return generateCityResponse(cityData);
                }
            }
            
            if (lowerMessage.includes('—Ñ–ª–æ—Ä–µ–Ω—Ü–∏—è') || lowerMessage.includes('florence') || lowerMessage.includes('firenze')) {
                if (lowerMessage.includes('–≤—Ä–µ–º–µ') || lowerMessage.includes('time') || lowerMessage.includes('–∫–æ–ª–∫–æ')) {
                    return currentLanguage.responses.timeEstimate;
                }
                else if (lowerMessage.includes('–ø–ª–∞–Ω') || lowerMessage.includes('plan')) {
                    return currentLanguage.responses.travelPlan;
                }
                else if (lowerMessage.includes('–±–∏–ª–µ—Ç') || lowerMessage.includes('ticket')) {
                    return currentLanguage.responses.onlineTickets;
                }
                else if (lowerMessage.includes('—Ü–µ–Ω') || lowerMessage.includes('price')) {
                    return currentLanguage.responses.prices;
                }
                else {
                    return generateCityResponse({
                        name: "–§–ª–æ—Ä–µ–Ω—Ü–∏—è",
                        info: {
                            mainAttractions: ["–ö–∞–ø–µ–ª–∞ –ú–µ–¥–∏—á–∏", "–ì–∞–ª–µ—Ä–∏—è –£—Ñ–∏—Ü–∏", "–ü–æ–Ω—Ç–µ –í–µ–∫—å–æ", "–ü–∏–∞—Ü–∞–ª–µ –ú–∏–∫–µ–ª–∞–Ω–¥–∂–µ–ª–æ"],
                            museums: ["–ì–∞–ª–µ—Ä–∏—è –£—Ñ–∏—Ü–∏", "–ê–∫–∞–¥–µ–º–∏—è", "–ü–∞–ª–∞—Ü–æ –ü–∏—Ç–∏"],
                            prices: { museums: "8-35‚Ç¨", transport: "5‚Ç¨/–¥–Ω–µ–≤–µ–Ω –±–∏–ª–µ—Ç", food: "15-30‚Ç¨ –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–µ" },
                            timeNeeded: "3-4 –¥–Ω–∏",
                            bestTime: "–ê–ø—Ä–∏–ª-–ú–∞–π, –°–µ–ø—Ç–µ–º–≤—Ä–∏-–û–∫—Ç–æ–º–≤—Ä–∏"
                        }
                    });
                }
            }
            
            return getPersonalizedFallback();
        }

        function updateUserProfile(message) {
            if (message.includes('–µ–≤—Ç–∏–Ω–æ') || message.includes('–±—é–¥–∂–µ—Ç') || message.includes('–∏–∫–æ–Ω–æ–º–∏—á–Ω–æ')) {
                userProfile.preferences.budget = 'budget';
            } else if (message.includes('–ª—É–∫—Å–æ–∑') || message.includes('—Å–∫—ä–ø')) {
                userProfile.preferences.budget = 'luxury';
            }
            
            if (message.includes('—Ä–æ–º–∞–Ω—Ç–∏—á') || message.includes('–º–µ–¥–µ–Ω –º–µ—Å–µ—Ü')) {
                userProfile.preferences.travelType = 'romantic';
            } else if (message.includes('–ø–ª–∞–∂') || message.includes('–º–æ—Ä–µ')) {
                userProfile.preferences.travelType = 'beach';
            } else if (message.includes('–∏—Å—Ç–æ—Ä–∏') || message.includes('–∫—É–ª—Ç—É—Ä')) {
                userProfile.preferences.travelType = 'culture';
            }
            
            if (message.includes('–ª—è—Ç–æ')) userProfile.preferences.season = 'summer';
            if (message.includes('–∑–∏–º–∞')) userProfile.preferences.season = 'winter';
            if (message.includes('–ø—Ä–æ–ª–µ—Ç')) userProfile.preferences.season = 'spring';
            if (message.includes('–µ—Å–µ–Ω')) userProfile.preferences.season = 'autumn';
        }

        function getSimilarCitiesResponse(message) {
            const targetCity = findCityInMessage(message);
            if (targetCity) {
                const similarCities = findSimilarCities(targetCity);
                return `
                    <div class="info-card">
                        <strong>üîç –ü–û–î–û–ë–ù–ò –ù–ê ${targetCity.name.toUpperCase()}:</strong><br><br>
                        ${similarCities.map(city => `
                            <div style="margin-bottom: 10px;">
                                <strong>üèôÔ∏è ${city.name}</strong><br>
                                <span style="color: #666; font-size: 10px;">${city.similarity}</span><br>
                                <span style="font-size: 10px;">üéØ ${city.info.mainAttractions.slice(0, 2).join(', ')}</span>
                            </div>
                        `).join('')}
                        <br><strong>üí° –°—ä–≤–µ—Ç:</strong> –¢–µ–∑–∏ –≥—Ä–∞–¥–æ–≤–µ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç –ø–æ–¥–æ–±–Ω–∏ –ø—Ä–µ–∂–∏–≤—è–≤–∞–Ω–∏—è!
                    </div>
                `;
            }
            return currentLanguage.responses.unknown;
        }

        function getPersonalizedRecommendations(message) {
            let recommendations = [];
            
            if (message.includes('–º–µ–¥–µ–Ω –º–µ—Å–µ—Ü') || message.includes('—Ä–æ–º–∞–Ω—Ç–∏—á–Ω–æ')) {
                recommendations = getRomanticCities();
            } else if (message.includes('—Å–µ–º–µ–π–Ω–æ') || message.includes('–¥–µ—Ü–∞')) {
                recommendations = getFamilyFriendlyCities();
            } else if (message.includes('–ø–ª–∞–∂') || message.includes('–º–æ—Ä–µ')) {
                recommendations = getBeachCities();
            } else if (message.includes('–∏—Å—Ç–æ—Ä–∏') || message.includes('–∫—É–ª—Ç—É—Ä')) {
                recommendations = getCulturalCities();
            } else {
                recommendations = getIntelligentRecommendations();
            }
            
            return `
                <div class="info-card">
                    <strong>üéØ –ü–ï–†–°–û–ù–ê–õ–ò–ó–ò–†–ê–ù–ò –ü–†–ï–ü–û–†–™–ö–ò:</strong><br><br>
                    ${recommendations.slice(0, 3).map((city, index) => `
                        <div style="margin-bottom: 12px;">
                            <strong>${getMedal(index)} ${city.name}</strong><br>
                            <span style="color: #666; font-size: 10px;">${city.reason}</span><br>
                            <span style="font-size: 10px;">üí∞ –ë—é–¥–∂–µ—Ç: ${city.info.prices.food} | ‚è±Ô∏è ${city.info.timeNeeded}</span>
                        </div>
                    `).join('')}
                    <br><strong>üí° –°—ä–≤–µ—Ç:</strong> –ò–∑–±–µ—Ä–∏ –≥—Ä–∞–¥ —Å–ø–æ—Ä–µ–¥ —Ç–≤–æ–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å–∏ –∏ –±—é–¥–∂–µ—Ç!
                </div>
            `;
        }

        function getBudgetRecommendations() {
            const budgetCities = Object.values(enhancedCityDatabase)
                .filter(city => city.budgetLevel === 'budget')
                .slice(0, 4);
            
            return `
                <div class="info-card">
                    <strong>üí∞ –ë–Æ–î–ñ–ï–¢–ù–ò –ì–†–ê–î–û–í–ï:</strong><br><br>
                    ${budgetCities.map(city => `
                        <div style="margin-bottom: 10px;">
                            <strong>üèôÔ∏è ${city.name}</strong><br>
                            <span style="font-size: 10px;">üíµ –•—Ä–∞–Ω–µ–Ω–µ: ${city.info.prices.food} | üöå –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç: ${city.info.prices.transport}</span><br>
                            <span style="font-size: 10px;">üéØ ${city.info.mainAttractions.slice(0, 2).join(', ')}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function getLuxuryRecommendations() {
            const luxuryCities = Object.values(enhancedCityDatabase)
                .filter(city => city.budgetLevel === 'luxury')
                .slice(0, 4);
            
            return `
                <div class="info-card">
                    <strong>üíé –õ–£–ö–°–û–ó–ù–ò –ì–†–ê–î–û–í–ï:</strong><br><br>
                    ${luxuryCities.map(city => `
                        <div style="margin-bottom: 10px;">
                            <strong>üèôÔ∏è ${city.name}</strong><br>
                            <span style="font-size: 10px;">üíµ –•—Ä–∞–Ω–µ–Ω–µ: ${city.info.prices.food} | üöñ –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç: ${city.info.prices.transport}</span><br>
                            <span style="font-size: 10px;">üéØ ${city.info.mainAttractions.slice(0, 2).join(', ')}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function getRomanticRecommendations() {
            const romanticCities = Object.values(enhancedCityDatabase)
                .filter(city => city.categories.includes('romantic'))
                .sort((a, b) => b.romanticScore - a.romanticScore)
                .slice(0, 4);
            
            return `
                <div class="info-card">
                    <strong>üíñ –†–û–ú–ê–ù–¢–ò–ß–ù–ò –ì–†–ê–î–û–í–ï:</strong><br><br>
                    ${romanticCities.map(city => `
                        <div style="margin-bottom: 10px;">
                            <strong>üèôÔ∏è ${city.name}</strong><br>
                            <span style="font-size: 10px;">‚ù§Ô∏è –†–æ–º–∞–Ω—Ç–∏—á–µ–Ω —Ä–µ–π—Ç–∏–Ω–≥: ${city.romanticScore}/10</span><br>
                            <span style="font-size: 10px;">üéØ ${city.info.mainAttractions.slice(0, 2).join(', ')}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function getBeachRecommendations() {
            const beachCities = Object.values(enhancedCityDatabase)
                .filter(city => city.categories.includes('beach'))
                .slice(0, 4);
            
            return `
                <div class="info-card">
                    <strong>üèñÔ∏è –ü–õ–ê–ñ–ù–ò –ì–†–ê–î–û–í–ï:</strong><br><br>
                    ${beachCities.map(city => `
                        <div style="margin-bottom: 10px;">
                            <strong>üèôÔ∏è ${city.name}</strong><br>
                            <span style="font-size: 10px;">üåä –ü–ª–∞–∂–Ω–∞ –¥–µ—Å—Ç–∏–Ω–∞—Ü–∏—è</span><br>
                            <span style="font-size: 10px;">üéØ ${city.info.mainAttractions.slice(0, 2).join(', ')}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function getCulturalRecommendations() {
            const culturalCities = Object.values(enhancedCityDatabase)
                .filter(city => city.categories.includes('culture') || city.categories.includes('history'))
                .slice(0, 4);
            
            return `
                <div class="info-card">
                    <strong>üé® –ö–£–õ–¢–£–†–ù–ò –ì–†–ê–î–û–í–ï:</strong><br><br>
                    ${culturalCities.map(city => `
                        <div style="margin-bottom: 10px;">
                            <strong>üèôÔ∏è ${city.name}</strong><br>
                            <span style="font-size: 10px;">üèõÔ∏è –ö—É–ª—Ç—É—Ä–Ω–æ –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–æ</span><br>
                            <span style="font-size: 10px;">üéØ ${city.info.mainAttractions.slice(0, 2).join(', ')}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function getSeasonalRecommendations(season) {
            const seasonalCities = Object.values(enhancedCityDatabase)
                .filter(city => city.bestSeasons.includes(season))
                .slice(0, 4);
            
            const seasonNames = {
                'summer': '–ª—è—Ç–æ',
                'winter': '–∑–∏–º–∞', 
                'spring': '–ø—Ä–æ–ª–µ—Ç',
                'autumn': '–µ—Å–µ–Ω'
            };
            
            return `
                <div class="info-card">
                    <strong>üå§Ô∏è –ì–†–ê–î–û–í–ï –ó–ê ${seasonNames[season].toUpperCase()}:</strong><br><br>
                    ${seasonalCities.map(city => `
                        <div style="margin-bottom: 10px;">
                            <strong>üèôÔ∏è ${city.name}</strong><br>
                            <span style="font-size: 10px;">üìÖ –ò–¥–µ–∞–ª–µ–Ω —Å–µ–∑–æ–Ω: ${city.info.bestTime}</span><br>
                            <span style="font-size: 10px;">üéØ ${city.info.mainAttractions.slice(0, 2).join(', ')}</span>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function findCityInMessage(message) {
            for (const [cityKey, cityData] of Object.entries(enhancedCityDatabase)) {
                if (cityData.keywords.some(keyword => message.includes(keyword))) {
                    return cityData;
                }
            }
            return null;
        }

        function findSimilarCities(targetCity) {
            return Object.values(enhancedCityDatabase)
                .filter(city => city.name !== targetCity.name)
                .map(city => {
                    const commonCategories = city.categories.filter(cat => 
                        targetCity.categories.includes(cat)
                    ).length;
                    const similarity = `${commonCategories} –æ–±—â–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏`;
                    return { ...city, similarity };
                })
                .sort((a, b) => {
                    const aCommon = a.categories.filter(cat => targetCity.categories.includes(cat)).length;
                    const bCommon = b.categories.filter(cat => targetCity.categories.includes(cat)).length;
                    return bCommon - aCommon;
                })
                .slice(0, 3);
        }

        function getRomanticCities() {
            return Object.values(enhancedCityDatabase)
                .filter(city => city.categories.includes('romantic'))
                .sort((a, b) => b.romanticScore - a.romanticScore)
                .slice(0, 3)
                .map(city => ({
                    ...city,
                    reason: `–†–æ–º–∞–Ω—Ç–∏—á–µ–Ω —Ä–µ–π—Ç–∏–Ω–≥: ${city.romanticScore}/10 - –∏–¥–µ–∞–ª–µ–Ω –∑–∞ –¥–≤–æ–π–∫–∏`
                }));
        }

        function getBeachCities() {
            return Object.values(enhancedCityDatabase)
                .filter(city => city.categories.includes('beach'))
                .slice(0, 3)
                .map(city => ({
                    ...city,
                    reason: `–ü–ª–∞–∂–Ω–∞ –¥–µ—Å—Ç–∏–Ω–∞—Ü–∏—è - –ø–µ—Ä—Ñ–µ–∫—Ç–Ω–∞ –∑–∞ —Ä–µ–ª–∞–∫—Å –∏ —Å–ª—ä–Ω—Ü–µ`
                }));
        }

        function getCulturalCities() {
            return Object.values(enhancedCityDatabase)
                .filter(city => city.categories.includes('culture') || city.categories.includes('history'))
                .slice(0, 3)
                .map(city => ({
                    ...city,
                    reason: `–ë–æ–≥–∞—Ç–æ –∫—É–ª—Ç—É—Ä–Ω–æ –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–æ - –º—É–∑–µ–∏ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ –ø–∞–º–µ—Ç–Ω–∏—Ü–∏`
                }));
        }

        function getFamilyFriendlyCities() {
            return Object.values(enhancedCityDatabase)
                .filter(city => city.familyFriendly)
                .slice(0, 3)
                .map(city => ({
                    ...city,
                    reason: `–°–µ–º–µ–π–Ω–æ –ø—Ä–∏—è—Ç–µ–ª—Å–∫–∏ - –ø–æ–¥—Ö–æ–¥—è—â –∑–∞ –¥–µ—Ü–∞ –∏ —Ä–æ–¥–∏—Ç–µ–ª–∏`
                }));
        }

        function getIntelligentRecommendations() {
            let cities = Object.values(enhancedCityDatabase);
            
            if (userProfile.preferences.budget) {
                cities = cities.filter(city => city.budgetLevel === userProfile.preferences.budget);
            }
            
            if (userProfile.preferences.travelType === 'romantic') {
                cities = cities.filter(city => city.categories.includes('romantic'))
                             .sort((a, b) => b.romanticScore - a.romanticScore);
            }
            
            if (userProfile.lastSearches.length > 0) {
                const lastCityName = userProfile.lastSearches[0];
                const lastCity = cities.find(city => city.name === lastCityName);
                if (lastCity) {
                    cities = findSimilarCities(lastCity);
                }
            }
            
            return cities.slice(0, 3).map(city => ({
                ...city,
                reason: `–ü—Ä–µ–ø–æ—Ä—ä—á–∞–Ω–æ –≤—ä–∑ –æ—Å–Ω–æ–≤–∞ –Ω–∞ –≤–∞—à–∏—Ç–µ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è`
            }));
        }

        function getMedal(index) {
            const medals = ["ü•á", "ü•à", "ü•â"];
            return medals[index] || "‚≠ê";
        }

        function getSearchHistory() {
            if (userProfile.lastSearches.length === 0) {
                return `<div class="tip-card"><strong>üìä –í—Å–µ –æ—â–µ –Ω—è–º–∞—Ç–µ –∏—Å—Ç–æ—Ä–∏—è –Ω–∞ —Ç—ä—Ä—Å–µ–Ω–∏—è—Ç–∞.</strong><br>–ó–∞–ø–æ—á–Ω–µ—Ç–µ –¥–∞ —Ç—ä—Ä—Å–∏—Ç–µ –≥—Ä–∞–¥–æ–≤–µ!</div>`;
            }
            
            return `
                <div class="info-card">
                    <strong>üìä –ò–°–¢–û–†–ò–Ø –ù–ê –¢–™–†–°–ï–ù–ï–¢–ê:</strong><br><br>
                    ${userProfile.lastSearches.map((city, index) => `
                        <strong>${index + 1}. ${city}</strong>
                    `).join('<br>')}
                    <br><br><strong>üí° –°—ä–≤–µ—Ç:</strong> –ü–∏—Ç–∞–π "–ø–æ–¥–æ–±–Ω–∏ –Ω–∞ [–≥—Ä–∞–¥]" –∑–∞ —Å–≤—ä—Ä–∑–∞–Ω–∏ –ø—Ä–µ–ø–æ—Ä—ä–∫–∏!
                </div>
            `;
        }

        function generateCityResponse(cityData) {
            return `
                <div class="info-card">
                    <strong>üèôÔ∏è ${cityData.name.toUpperCase()} - –ü–™–õ–ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø</strong><br><br>
                    
                    <strong>üéØ –û–°–ù–û–í–ù–ò –ê–¢–†–ê–ö–¶–ò–ò:</strong><br>
                    ${cityData.info.mainAttractions.map(attr => `‚Ä¢ ${attr}`).join('<br>')}<br><br>
                    
                    <strong>üé® –ú–£–ó–ï–ò:</strong><br>
                    ${cityData.info.museums.map(museum => `‚Ä¢ ${museum}`).join('<br>')}<br><br>
                    
                    <strong>üí∞ –¶–ï–ù–ò:</strong><br>
                    ‚Ä¢ –ú—É–∑–µ–∏: ${cityData.info.prices.museums}<br>
                    ‚Ä¢ –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç: ${cityData.info.prices.transport}<br>
                    ‚Ä¢ –•—Ä–∞–Ω–µ–Ω–µ: ${cityData.info.prices.food}<br><br>
                    
                    <strong>‚è±Ô∏è –ü–†–ï–ü–û–†–™–ß–ò–¢–ï–õ–ù–û –í–†–ï–ú–ï:</strong> ${cityData.info.timeNeeded}<br>
                    <strong>üìÖ –ù–ê–ô-–î–û–ë–™–† –°–ï–ó–û–ù:</strong> ${cityData.info.bestTime}<br><br>
                    
                    <strong>üè∑Ô∏è –ö–ê–¢–ï–ì–û–†–ò–ò:</strong> ${cityData.categories.join(', ')}<br>
                    <strong>üíé –ë–Æ–î–ñ–ï–¢:</strong> ${getBudgetLevelText(cityData.budgetLevel)}
                </div>
            `;
        }

        function getBudgetLevelText(level) {
            const levels = {
                'budget': 'üí∞ –ë—é–¥–∂–µ—Ç–µ–Ω',
                'medium': 'üíµ –°—Ä–µ–¥–µ–Ω', 
                'luxury': 'üíé –õ—É–∫—Å–æ–∑–µ–Ω'
            };
            return levels[level] || level;
        }

        function getPersonalizedFallback() {
            if (userProfile.lastSearches.length > 0) {
                const lastCityName = userProfile.lastSearches[0];
                const lastCity = Object.values(enhancedCityDatabase).find(city => city.name === lastCityName);
                if (lastCity) {
                    const similar = findSimilarCities(lastCity).slice(0, 2);
                    return `
                        <div class="tip-card">
                            <strong>ü§î –ù–µ —Ä–∞–∑–±—Ä–∞—Ö –≤—ä–ø—Ä–æ—Å–∞ –≤–∏ –Ω–∞–ø—ä–ª–Ω–æ.</strong><br><br>
                            <strong>üí° –í—ä–∑ –æ—Å–Ω–æ–≤–∞ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—è—Ç–∞ –≤–∏, –º–æ–∂–µ –¥–∞ –≤–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É–≤–∞:</strong><br>
                            ${similar.map(city => `‚Ä¢ ${city.name}`).join('<br>')}<br><br>
                            –ò–ª–∏ –ø–æ–ø–∏—Ç–∞–π—Ç–µ –∑–∞:<br>
                            ‚Ä¢ <strong>–í—Ä–µ–º–µ</strong> –∑–∞ –ø–æ—Å–µ—â–µ–Ω–∏—è<br>
                            ‚Ä¢ <strong>–ë–∏–ª–µ—Ç–∏</strong> –∏ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏<br>
                            ‚Ä¢ <strong>–ü–ª–∞–Ω–æ–≤–µ</strong> –∑–∞ –ø—ä—Ç—É–≤–∞–Ω–µ<br>
                            ‚Ä¢ <strong>–¶–µ–Ω–∏</strong> –∑–∞ –º—É–∑–µ–∏
                        </div>
                    `;
                }
            }
            
            return currentLanguage.responses.unknown;
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') sendMessage();
        }
        
        function askQuestion(type) {
            let question = '';
            switch(type) {
                case 'onlineTickets': question = currentLanguage.texts.onlineTickets; break;
                case 'timeEstimate': question = currentLanguage.texts.timeEstimate; break;
                case 'travelPlan': question = currentLanguage.texts.travelPlan; break;
                case 'prices': question = currentLanguage.texts.prices; break;
            }
            document.getElementById('userInput').value = question;
            sendMessage();
        }
        
        function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            if (!message) return;
            
            addMessage(message, 'user');
            input.value = '';
            
            setTimeout(() => {
                const aiResponse = getAIResponse(message);
                addMessage(aiResponse, 'ai');
            }, 800);
        }
        
        function addMessage(text, sender) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            if (sender === 'user') {
                messageDiv.innerHTML = `<strong>üë§ –í–∏–µ:</strong> ${text}`;
            } else {
                messageDiv.innerHTML = text;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
    </script>
</body>
</html>
